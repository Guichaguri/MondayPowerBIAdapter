<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>Monday to Power BI Adapter</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;900&display=swap" rel="stylesheet">
        <link href="./styles.css" rel="stylesheet">
    </head>
    <body>
        <main>
            <h1>Monday.com to Power BI Adapter</h1>
            <p>This is an adapter that retrieves data from the Monday API v2 and converts to a Power BI friendly format while keeping the API key hidden</p>

            <form id="create-url">
                <label class="label">
                    <span>API Token (v2)</span>
                    <input type="text" name="key" autocomplete="monday_token" />
                </label>

                <label class="label">
                    <span>Board (ID or URL)</span>
                    <input type="text" name="board" placeholder="https://monday.com/boards/000000000" autocomplete="monday_board" />
                </label>

                <label class="checkbox">
                    <input type="checkbox" name="dismember">
                    <div>
                        <span>Formatted columns</span>
                        <em>Adapt specific columns data to be easier to work with in Power BI.</em>
                    </div>
                </label>

                <label class="checkbox">
                    <input type="checkbox" name="subitems">
                    <div>
                        <span>Subitems</span>
                        <em>Multiply the lines by each subitem and adds the subitems columns.</em>
                    </div>
                </label>

                <label class="checkbox">
                    <input type="checkbox" name="safe" checked>
                    <div>
                        <span>Hide the API Token</span>
                        <em>Instead of exposing the API token, which gives full access to your account, generate a key that only works for the specified board.</em>
                    </div>
                </label>

                <label class="checkbox">
                    <input type="checkbox" name="comma">
                    <div>
                        <span>Decimal Separator using Commas</span>
                        <em>Instead of separating decimals with a dot, uses a comma. Example: <code>14.5</code> becomes <code>14,5</code>.</em>
                    </div>
                </label>

                <input type="submit" value="Adapt it!">
            </form>

            <div id="status">
                <span id="text"></span>
                <span id="url"></span>
            </div>

            <p>Developed by <a href="https://github.com/Guichaguri" target="_blank">Guilherme Chaguri</a>. The code is be available on <a href="https://github.com/Guichaguri/MondayPowerBIAdapter" target="_blank">GitHub</a></p>
            <p style="font-size: 0.8em;">I've also created a <a href="https://gist.github.com/Guichaguri/83a6d8ab6ce3a695dc104bb4eff9d73d" target="_blank">Power Query to directly connect to the Monday.com API</a>, it's harder to setup, doesn't secure the API key, formats columns or include subitems but avoids a third-party service.</p>
        </main>

        <script src="./scripts.js" type="text/javascript"></script>
    </body>

</html>
